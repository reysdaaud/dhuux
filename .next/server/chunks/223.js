exports.id=223;exports.ids=[223];exports.modules={4780:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var o=r(49384);var s=r(82348);function n(...e){return(0,s.QP)((0,o.$)(e))}},14947:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>b});var o=r(60687);var s=r(29867);var n=r(43210);var i=r(47313);var a=r(24224);var c=r(78726);var l=r(4780);const d=i.Kq;const u=n.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.LM,{ref:r,className:(0,l.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));u.displayName=i.LM.displayName;const f=(0,a.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}});const p=n.forwardRef(({className:e,variant:t,...r},s)=>{return(0,o.jsx)(i.bL,{ref:s,className:(0,l.cn)(f({variant:t}),e),...r})});p.displayName=i.bL.displayName;const m=n.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.rc,{ref:r,className:(0,l.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));m.displayName=i.rc.displayName;const g=n.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.bm,{ref:r,className:(0,l.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,o.jsx)(c.A,{className:"h-4 w-4"})}));g.displayName=i.bm.displayName;const h=n.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.hE,{ref:r,className:(0,l.cn)("text-sm font-semibold",e),...t}));h.displayName=i.hE.displayName;const v=n.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.VY,{ref:r,className:(0,l.cn)("text-sm opacity-90",e),...t}));v.displayName=i.VY.displayName;function b(){const{toasts:e}=(0,s.dj)();return(0,o.jsxs)(d,{children:[e.map(function({id:e,title:t,description:r,action:s,...n}){return(0,o.jsxs)(p,{...n,children:[(0,o.jsxs)("div",{className:"grid gap-1",children:[t&&(0,o.jsx)(h,{children:t}),r&&(0,o.jsx)(v,{children:r})]}),s,(0,o.jsx)(g,{})]},e)}),(0,o.jsx)(u,{})]})}},29131:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>n});var o=r(12907);var s=r.n(o);const n=(0,o.registerClientReference)(function(){throw new Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\AuthContext.tsx","AuthProvider");const i=(0,o.registerClientReference)(function(){throw new Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\AuthContext.tsx","useAuth");const a=(0,o.registerClientReference)(function(){throw new Error("Attempted to call signInWithGoogle() from the server but signInWithGoogle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\AuthContext.tsx","signInWithGoogle");const c=(0,o.registerClientReference)(function(){throw new Error("Attempted to call signOutUser() from the server but signOutUser is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\AuthContext.tsx","signOutUser")},29867:(e,t,r)=>{"use strict";r.d(t,{dj:()=>v});var o=r(43210);var s=r.n(o);const n=1;const i=1e6;const a={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let c=0;function l(){c=(c+1)%Number.MAX_SAFE_INTEGER;return c.toString()}const d=new Map;const u=e=>{if(d.has(e)){return}const t=setTimeout(()=>{d.delete(e);g({type:"REMOVE_TOAST",toastId:e})},i);d.set(e,t)};const f=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{const{toastId:r}=t;if(r){u(r)}else{e.toasts.forEach(e=>{u(e.id)})}return{...e,toasts:e.toasts.map(e=>e.id===r||r===undefined?{...e,open:false}:e)}}case"REMOVE_TOAST":if(t.toastId===undefined){return{...e,toasts:[]}}return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}};const p=[];let m={toasts:[]};function g(e){m=f(m,e);p.forEach(e=>{e(m)})}function h({...e}){const t=l();const r=e=>g({type:"UPDATE_TOAST",toast:{...e,id:t}});const o=()=>g({type:"DISMISS_TOAST",toastId:t});g({type:"ADD_TOAST",toast:{...e,id:t,open:true,onOpenChange:e=>{if(!e)o()}}});return{id:t,dismiss:o,update:r}}function v(){const[e,t]=o.useState(m);o.useEffect(()=>{p.push(t);return()=>{const e=p.indexOf(t);if(e>-1){p.splice(e,1)}}},[e]);return{...e,toast:h,dismiss:e=>g({type:"DISMISS_TOAST",toastId:e})}}},40942:(e,t,r)=>{"use strict";r.d(t,{F4:()=>c});var o=r(82634);var s=r(75535);const n=10;const i=10;const a=10;async function c(e,t,r){console.log(`[ContentAccess] Checking access for contentId: ${e}, userId: ${r}`);if(!r||!t){console.warn("[ContentAccess] No userId or userProfile provided.");return{canAccess:false,message:"User not authenticated or profile not loaded.",profileWasUpdated:false}}const c=(0,s.H9)(o.db,"users",r);if(t.consumedContentIds?.includes(e)){console.log(`[ContentAccess] User ${r} already consumed ${e}. Access granted.`);return{canAccess:true,profileWasUpdated:false,newBalance:t.coins,showLowBalanceWarning:(t.coins||0)<a}}const l=t.freeContentConsumedCount||0;const d=t.coins||0;let u={consumedContentIds:(0,s.hq)(e),updatedAt:(0,s.O5)()};let f=d;let p="";if(l<n){u.freeContentConsumedCount=(0,s.GV)(1);f=d;p="free tier";console.log(`[ContentAccess] Granting access via ${p} for content ${e} to user ${r}. New free count: ${l+1}.`)}else if(d>=i){u.coins=(0,s.GV)(-i);f=d-i;p="paid tier";console.log(`[ContentAccess] Granting access via ${p} for content ${e} to user ${r}. Deducting ${i} coins. Old balance: ${d}, New balance: ${f}.`)}else{console.log(`[ContentAccess] User ${r} has insufficient coins/free tier for content ${e}. Balance: ${d}, Free count: ${l}.`);return{canAccess:false,message:`Insufficient coins or free plays. This content costs ${i} coins or uses a free play. Your balance: ${d} coins, Free plays left: ${n-l}. Please top up.`,profileWasUpdated:false,newBalance:d}}try{await (0,s.mZ)(c,u);console.log(`[ContentAccess] Firestore updated for user ${r} after consuming ${e} via ${p}.`);return{canAccess:true,profileWasUpdated:true,newBalance:f,showLowBalanceWarning:f<a}}catch(t){console.error(`[ContentAccess] Error updating Firestore for ${p} consumption for user ${r}, content ${e}:`,t);return{canAccess:false,message:"Failed to record content access. Please try again.",profileWasUpdated:false,newBalance:d}}}},54636:(e,t,r)=>{"use strict";r.d(t,{PlayerProvider:()=>n});var o=r(12907);var s=r.n(o);const n=(0,o.registerClientReference)(function(){throw new Error("Attempted to call PlayerProvider() from the server but PlayerProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\PlayerContext.tsx","PlayerProvider");const i=(0,o.registerClientReference)(function(){throw new Error("Attempted to call usePlayer() from the server but usePlayer is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\contexts\\PlayerContext.tsx","usePlayer")},55442:(e,t,r)=>{"use strict";r.d(t,{F:()=>f,PlayerProvider:()=>u});var o=r(60687);var s=r.n(o);var n=r(43210);var i=r.n(n);var a=r(63213);var c=r(40942);var l=r(29867);const d=(0,n.createContext)(undefined);const u=({children:e})=>{const[t,r]=(0,n.useState)(null);const[s,i]=(0,n.useState)(false);const[u,f]=(0,n.useState)(false);const p=(0,n.useRef)(null);const{user:m,userProfile:g,refreshUserProfile:h}=(0,a.As)();const{toast:v}=(0,l.dj)();const b=(0,n.useCallback)(()=>{const e=p.current;if(!e)return;if(s&&e.src&&e.src!==window.location.href&&!e.src.startsWith("blob:")){e.play().catch(e=>{console.error("[PlayerContext] Error attempting to play audio on loadeddata:",e);if(e.name==="NotAllowedError"||e.name==="NotSupportedError"){i(false)}})}},[s]);const y=(0,n.useCallback)(()=>{const e=p.current;if(!e)return;if(s&&e.paused&&e.src&&e.src!==window.location.href&&!e.src.startsWith("blob:")){e.play().catch(e=>{console.error("[PlayerContext] Error attempting to play audio on canplay:",e);if(e.name==="NotAllowedError"||e.name==="NotSupportedError"){i(false)}})}},[s]);(0,n.useEffect)(()=>{if(!p.current){p.current=new Audio}const e=p.current;const t=()=>{i(false)};const r=t=>{if(e&&e.error){console.error("[PlayerContext] Audio Player Error Code:",e.error.code,"for src:",e.currentSrc);console.error("[PlayerContext] Audio Player Error Message:",e.error.message||"No specific message.")}else{console.error("[PlayerContext] Audio Player Error (unknown details or error object missing):",t,"for src:",e?.currentSrc)}i(false)};e.addEventListener("ended",t);e.addEventListener("error",r);e.addEventListener("loadeddata",b);e.addEventListener("canplay",y);return()=>{e.removeEventListener("ended",t);e.removeEventListener("error",r);e.removeEventListener("loadeddata",b);e.removeEventListener("canplay",y)}},[b,y]);(0,n.useEffect)(()=>{const e=p.current;if(!e){if(s)i(false);return}if(!t||!t.audioSrc){e.pause();if(e.src&&e.src!==""){e.src=""}if(s)i(false);if("mediaSession"in navigator){navigator.mediaSession.metadata=null;navigator.mediaSession.playbackState="none"}return}if(e.src!==t.audioSrc){e.src=t.audioSrc;e.load()}if(s){if(e.src&&e.src!==window.location.href&&!e.src.startsWith("blob:")){const t=e.play();if(t!==undefined){t.catch(t=>{console.error("[PlayerContext] Error attempting to play audio in isPlaying/currentTrack effect:",t);if(e.error){console.error(`[PlayerContext] Audio Element Error details: code ${e.error.code}, message: ${e.error.message||"No specific message."}`)}i(false)})}}else if(s){console.warn("[PlayerContext] Attempted to play with invalid or unready src. Stopping playback.");i(false)}}else{e.pause()}if("mediaSession"in navigator){if(t){console.log("[PlayerContext] Updating MediaSession. Current Track:",t.title,"Artist:",t.artist,"Image:",t.imageUrl);const e=[];if(t.imageUrl&&typeof t.imageUrl==="string"&&(t.imageUrl.startsWith("http://")||t.imageUrl.startsWith("https://"))){e.push({src:t.imageUrl,sizes:"96x96 128x128 192x192 256x256 384x384 512x512",type:"image/png"})}else{console.warn(`[PlayerContext] MediaSession: Invalid or non-absolute imageUrl for track '${t.title}':`,t.imageUrl,". Lock screen artwork may not display.")}navigator.mediaSession.metadata=new MediaMetadata({title:t.title,artist:t.artist||"Unknown Artist",album:"Minti App",artwork:e});navigator.mediaSession.playbackState=s?"playing":"paused"}else{navigator.mediaSession.metadata=null;navigator.mediaSession.playbackState="none"}}},[s,t]);const A=(0,n.useCallback)(()=>{if(t){i(e=>!e)}else{i(false)}},[t]);(0,n.useEffect)(()=>{if(!("mediaSession"in navigator))return;const e=p.current;if(!e)return;const r=[["play",()=>{if(t)A()}],["pause",()=>{if(t)A()}],["seekbackward",t=>{e.currentTime=Math.max(0,e.currentTime-(t.seekOffset||10))}],["seekforward",t=>{e.currentTime=Math.min(e.duration||Infinity,e.currentTime+(t.seekOffset||10))}]];for(const[e,t]of r){try{navigator.mediaSession.setActionHandler(e,t)}catch(t){console.warn(`[PlayerContext] Media session action "${e}" not supported.`)}}return()=>{for(const[e]of r){try{navigator.mediaSession.setActionHandler(e,null)}catch(e){}}}},[t,A]);const P=(0,n.useCallback)(async e=>{console.log("[PlayerContext] setCurrentTrackCb called for track:",e.id,e.title);if(!m||!g){v({title:"Authentication Required",description:"Please sign in to play content.",variant:"destructive"});i(false);r(null);return}if(!e.audioSrc){v({title:"Audio Unavailable",description:"This item does not have an audio source.",variant:"destructive"});i(false);r(null);return}const t=await (0,c.F4)(e.id,g,m.uid);if(t.canAccess){console.log("[PlayerContext] Access granted for track:",e.id,"Result:",t);r(e);i(true);if(t.profileWasUpdated&&h){console.log("[PlayerContext] User profile was updated by content access, refreshing profile.");await h()}if(t.showLowBalanceWarning){v({title:"Low Balance Warning",description:`Your coin balance is now ${t.newBalance}. Please top up soon!`,variant:"default",duration:7e3})}}else{console.log("[PlayerContext] Access denied for track:",e.id,"Message:",t.message);v({title:"Access Denied",description:t.message||"You do not have access to this content.",variant:"destructive"});i(false);r(null)}},[m,g,v,h]);return(0,o.jsx)(d.Provider,{value:{currentTrack:t,isPlaying:s,setCurrentTrack:P,togglePlayPause:A,isPlayerOpen:u,setIsPlayerOpen:f,audioElementRef:p},children:e})};const f=()=>{const e=(0,n.useContext)(d);if(e===undefined){throw new Error("usePlayer must be used within a PlayerProvider")}return e}},63213:(e,t,r)=>{"use strict";r.d(t,{As:()=>o.Z2,AuthProvider:()=>o.OJ});var o=r(82634)},68067:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,86346,23));Promise.resolve().then(r.t.bind(r,27924,23));Promise.resolve().then(r.t.bind(r,35656,23));Promise.resolve().then(r.t.bind(r,40099,23));Promise.resolve().then(r.t.bind(r,38243,23));Promise.resolve().then(r.t.bind(r,28827,23));Promise.resolve().then(r.t.bind(r,62763,23));Promise.resolve().then(r.t.bind(r,97173,23))},68747:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,16444,23));Promise.resolve().then(r.t.bind(r,16042,23));Promise.resolve().then(r.t.bind(r,88170,23));Promise.resolve().then(r.t.bind(r,49477,23));Promise.resolve().then(r.t.bind(r,29345,23));Promise.resolve().then(r.t.bind(r,12089,23));Promise.resolve().then(r.t.bind(r,46577,23));Promise.resolve().then(r.t.bind(r,31307,23))},79737:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>n});var o=r(12907);var s=r.n(o);const n=(0,o.registerClientReference)(function(){throw new Error("Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\HP EliteBook\\Desktop\\minti\\minti-main\\src\\components\\ui\\toaster.tsx","Toaster")},82634:(e,t,r)=>{"use strict";r.d(t,{OJ:()=>h,j2:()=>f,db:()=>p,Z2:()=>g});var o=r(60687);var s=r(67989);var n=r(93090);var i=r(75535);var a=r(43210);const c=async e=>{if(!e){console.error("[UserManagement] User not provided for initialization.");return}try{const t=(0,i.H9)(p,"users",e.uid);const r=await (0,i.x7)(t);if(!r.exists()){const r=e.displayName?.split(" ")||[];const o=r[0]||"";const s=r.slice(1).join(" ")||"";await (0,i.BN)(t,{uid:e.uid,name:e.displayName||`${o} ${s}`.trim(),email:e.email,photoURL:e.photoURL,firstName:o,lastName:s,country:"",mobile:"",profileComplete:false,preferredCategories:[],isAdmin:false,coins:0,freeContentConsumedCount:0,consumedContentIds:[],likedContentIds:[],savedContentIds:[],lastLogin:(0,i.O5)(),createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()});console.log("[UserManagement] User initialized in Firestore:",e.uid)}else{const o=r.data();const s={lastLogin:(0,i.O5)(),updatedAt:(0,i.O5)()};if(typeof o.profileComplete==="undefined")s.profileComplete=false;if(!o.preferredCategories)s.preferredCategories=[];if(typeof o.isAdmin==="undefined")s.isAdmin=false;if(typeof o.coins==="undefined")s.coins=0;if(typeof o.freeContentConsumedCount==="undefined")s.freeContentConsumedCount=0;if(!o.consumedContentIds)s.consumedContentIds=[];if(!o.likedContentIds)s.likedContentIds=[];if(!o.savedContentIds)s.savedContentIds=[];if(Object.keys(s).length>2){await (0,i.mZ)(t,s);console.log("[UserManagement] Existing user document updated with new fields:",e.uid,s)}else{await (0,i.mZ)(t,{lastLogin:(0,i.O5)(),updatedAt:(0,i.O5)()})}}}catch(e){console.error("[UserManagement] Error initializing/updating user:",e)}};var l=r(16189);const d={apiKey:"AIzaSyAl1iiyOrU49GOJdezPc-6zQPeonpJxl0I",authDomain:"wirenext-b4b65.firebaseapp.com",projectId:"wirenext-b4b65",storageBucket:"wirenext-b4b65.appspot.com",messagingSenderId:"486545175288",appId:"1:486545175288:web:6d53203232567ae786810d",measurementId:"G-9H1ZKBRWK0"};let u;let f;let p;if(!(0,s.Dk)().length){u=(0,s.Wp)(d)}else{u=(0,s.Dk)()[0]}f=(0,n.xI)(u);p=(0,i.aU)(u);const m=(0,a.createContext)(undefined);const g=()=>{const e=(0,a.useContext)(m);if(e===undefined){throw new Error("useAuthContext must be used within an AuthProvider")}return e};const h=({children:e})=>{const[t,r]=(0,a.useState)(null);const[s,d]=(0,a.useState)(null);const[u,g]=(0,a.useState)(true);const[h,v]=(0,a.useState)(true);const[b,y]=(0,a.useState)(null);const A=(0,l.useRouter)();const P=(0,l.usePathname)();const C=(0,a.useCallback)(async e=>{if(!e){d(null);v(false);console.log("[AuthProvider] fetchUserProfile: No current user, profile set to null.");return}console.log(`[AuthProvider] fetchUserProfile: Fetching profile for user ${e.uid}`);v(true);try{const t=(0,i.H9)(p,"users",e.uid);const r=await (0,i.x7)(t);if(r.exists()){d(r.data());console.log("[AuthProvider] fetchUserProfile: Profile fetched successfully.",r.data())}else{d(null);console.warn("[AuthProvider] fetchUserProfile: User document not found in Firestore after initialization attempt.")}}catch(e){console.error("[AuthProvider] fetchUserProfile: Error fetching user profile:",e);y(e);d(null)}finally{v(false);console.log("[AuthProvider] fetchUserProfile: Profile fetching complete.")}},[]);const x=(0,a.useCallback)(async()=>{const e=f.currentUser;console.log("[AuthProvider] refreshUserProfile called.");if(e){await C(e)}else{console.log("[AuthProvider] refreshUserProfile: No current user to refresh profile for.")}},[C]);(0,a.useEffect)(()=>{console.log("[AuthProvider] Setting up onAuthStateChanged listener.");const e=f.onAuthStateChanged(async e=>{console.log("[AuthProvider] onAuthStateChanged triggered. Current user:",e?.uid||"None");g(true);v(true);r(e);if(e){console.log("[AuthProvider] onAuthStateChanged: User detected. Initializing and fetching profile.");try{await c(e);await C(e)}catch(e){console.error("[AuthProvider] onAuthStateChanged: Error during user processing:",e);y(e);d(null);v(false)}}else{console.log("[AuthProvider] onAuthStateChanged: No user. Clearing profile.");d(null);v(false)}g(false);console.log("[AuthProvider] onAuthStateChanged: Auth state processing complete. Loading:",false,"isUserProfileLoading:",h)},e=>{console.error("[AuthProvider] onAuthStateChanged: Listener error:",e);y(e);r(null);d(null);g(false);v(false)});return()=>{console.log("[AuthProvider] Cleaning up onAuthStateChanged listener.");e()}},[C]);(0,a.useEffect)(()=>{console.log(`[AuthProvider] Redirection check. Auth Loading: ${u}, Profile Loading: ${h}, User: ${t?.uid}, Path: ${P}`);if(u||h){console.log("[AuthProvider] Redirection check: Auth or profile still loading, waiting.");return}const e=P==="/auth/signin";const r=P==="/profile/setup";const o=P==="/profile/preferences";if(t){console.log("[AuthProvider] Redirection check: User is logged in.");if(e){console.log("[AuthProvider] User logged in and on sign-in page, redirecting to /");A.replace("/");return}if(s&&!s.profileComplete&&!r&&!o){console.log("[AuthProvider] User profile not complete, redirecting to /profile/setup");A.replace("/profile/setup");return}if(s&&s.profileComplete&&(!s.preferredCategories||s.preferredCategories.length===0)&&!o){console.log("[AuthProvider] User profile complete, but no preferences. Redirecting to /profile/preferences");A.replace("/profile/preferences");return}if(s&&s.profileComplete&&r){console.log("[AuthProvider] User on setup page, but profile complete. Redirecting based on preferences.");if(!s.preferredCategories||s.preferredCategories.length===0){A.replace("/profile/preferences")}else{A.replace("/")}return}if(s&&!s.profileComplete&&o){console.log("[AuthProvider] User on preferences page, but profile incomplete. Redirecting to /profile/setup.");A.replace("/profile/setup");return}if(s&&s.profileComplete&&s.preferredCategories&&s.preferredCategories.length>0&&o){console.log("[AuthProvider] User on preferences page, but preferences already set. Redirecting to /.");A.replace("/");return}}else{console.log("[AuthProvider] Redirection check: No user logged in.");if(!e){console.log(`[AuthProvider] No user, not on auth page (current: ${P}), redirecting to /auth/signin.`);A.replace("/auth/signin")}}},[t,s,u,h,A,P]);const w=async()=>{console.log("[AuthProvider] signInWithGoogle called.");y(null);try{const e=new n.HF;const t=await (0,n.df)(f,e);console.log("[AuthProvider] signInWithGoogle successful for user:",t.user?.uid);return t.user}catch(e){console.error("[AuthProvider] signInWithGoogle: Error:",e);y(e);throw e}};const k=async()=>{console.log("[AuthProvider] signOutUser called.");try{await (0,n.CI)(f);console.log("[AuthProvider] signOutUser successful.")}catch(e){console.error("[AuthProvider] signOutUser: Error:",e);y(e);throw e}};const S={user:t,userProfile:s,signInWithGoogle:w,signOutUser:k,loading:u,isUserProfileLoading:h,error:b,firebaseAuth:f,refreshUserProfile:x};return(0,o.jsx)(m.Provider,{value:S,children:e})}},85371:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,47429,23));Promise.resolve().then(r.bind(r,79737));Promise.resolve().then(r.bind(r,29131));Promise.resolve().then(r.bind(r,54636))},91818:()=>{},94431:(e,t,r)=>{"use strict";r.r(t);r.d(t,{"default":()=>b,metadata:()=>v});var o=r(37413);var s=r.n(o);var n=r(22376);var i=r.n(n);var a=r(68726);var c=r.n(a);var l=r(3324);var d=r.n(l);var u=r(36162);var f=r(91818);var p=r.n(f);var m=r(79737);var g=r(29131);var h=r(54636);const v={title:"KeyFind - Stream Premium Content",description:"Watch premium videos and read exclusive articles"};function b({children:e}){return(0,o.jsxs)("html",{lang:"en",className:"dark",children:[(0,o.jsxs)(d(),{children:[(0,o.jsx)("link",{rel:"stylesheet",href:"https://static.files.bbci.co.uk/sounds/web/sounds-web/css/sounds.b5f058e20032d7f8020f.css"}),(0,o.jsx)("link",{rel:"stylesheet",href:"https://static.files.bbci.co.uk/orbit/bde9d3f679d1dd3f8768859cc949031d/css/orbit-ltr.min.css"})]}),(0,o.jsxs)("body",{className:`${i().variable} ${c().variable} font-sans antialiased`,children:[(0,o.jsx)(g.AuthProvider,{children:(0,o.jsxs)(h.PlayerProvider,{children:[e,(0,o.jsx)(m.Toaster,{})]})}),(0,o.jsx)(u["default"],{src:"https://nav.files.bbci.co.uk/orbit/3.0.0-536.85fa13b8/js/api.min.js",strategy:"beforeInteractive"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/sounds/web/sounds-web/js/vendor.b5f058e20032d7f8020f.js",strategy:"beforeInteractive"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/sounds/web/sounds-web/js/main.b5f058e20032d7f8020f.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/sounds/web/sounds-web/js/sounds.b5f058e20032d7f8020f.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/account/id-cta/738/js/id-cta.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://mybbc.files.bbci.co.uk/notification-ui/5.2.0/js/notifications.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/reverb/3.9.2/reverb.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/cookies/0.0.5-223.cc07cea/js/cookies.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://static.files.bbci.co.uk/ukomtracking/1.1.2/js/ukomtracking.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{src:"https://sa.bbc.co.uk/bbc/bbc/s?name=sounds.play.episode&ml_name=webmodule&ml_version=3.9.2&language=en&pal_route=episode&app_name=sounds&app_version=3.9.2&prod_name=sounds&bbc_site=sounds",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{id:"bbc-module-init",strategy:"lazyOnload",children:`
            if (typeof require !== 'undefined') {
              try {
                require(['orb/api'], function(orbApi) {
                  if (orbApi && typeof orbApi.init === 'function') orbApi.init();
                });
              } catch (e) { console.error("Error initializing orbApi:", e); }

              try {
                require(['idcta/idcta-1'], function(idcta) {
                  if (idcta && typeof idcta.init === 'function') idcta.init();
                });
              } catch (e) { console.error("Error initializing idcta:", e); }

              try {
                require(['reverb/reverb-3'], function(reverb) {
                  if (reverb && typeof reverb.init === 'function') reverb.init();
                });
              } catch (e) { console.error("Error initializing reverb:", e); }
            } else {
              console.warn("RequireJS (or equivalent) not loaded by BBC scripts, manual initialization might be needed or some features may not work.");
            }
          `}),(0,o.jsx)(u["default"],{src:"https://cdn.optimizely.com/js/4802190303.js",strategy:"lazyOnload"}),(0,o.jsx)(u["default"],{id:"bbc-page-setup",strategy:"lazyOnload",children:`
            window.bbcpage = window.bbcpage || {};
            window.bbcpage.loadModule = window.bbcpage.loadModule || function(deps) {
              return new Promise(function (resolve, reject) {
                if (typeof require !== 'undefined') {
                  require(deps, function () {
                    resolve.apply(this, arguments);
                  }, function(err) {
                    console.error("Error loading BBC module:", deps, err);
                    reject(err);
                  });
                } else {
                  console.warn("RequireJS not available for bbcpage.loadModule for deps:", deps);
                  reject(new Error("RequireJS not available"));
                }
              });
            };
          `})]})]})}},95987:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,79167,23));Promise.resolve().then(r.bind(r,14947));Promise.resolve().then(r.bind(r,63213));Promise.resolve().then(r.bind(r,55442))}};